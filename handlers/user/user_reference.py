# -*- coding: utf-8 -*-
from aiogram import F
from aiogram.fsm.context import FSMContext
from aiogram.types import CallbackQuery

from database import AdminBlockUser
from dispatcher import bot, router
from keyboards.keyboards import start_menu_keyboard
from loguru import logger


@router.callback_query(F.data == "reference")
async def reference(callback_query: CallbackQuery, state: FSMContext):
    """‚úÖ –°–ø—Ä–∞–≤–∫–∞"""
    id_user = callback_query.from_user.id  # id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    block = AdminBlockUser.select().where(AdminBlockUser.block_id == id_user).first()
    if block:
        logger.warning(f"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {id_user} –ø–æ–ø—ã—Ç–∞–ª—Å—è –≤–æ–π—Ç–∏")
        await bot.send_message(
            chat_id=callback_query.from_user.id,
            text="‚ùå –í–∞–º –∑–∞–ø—Ä–µ—â—ë–Ω –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–º—É –±–æ—Ç—É.",
        )
        return  # –ü—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

    text = (
        "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–æ—Ç –¥–ª—è —É—á–µ—Ç–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–∞ —Ä–∞–±–æ—á–µ–º –º–µ—Å—Ç–µ!\n\n"
        "–≠—Ç–æ—Ç –±–æ—Ç –ø–æ–º–æ–≥–∞–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–∞ —Ä–∞–±–æ—á–µ–º –º–µ—Å—Ç–µ –∏ —É–≤–µ–¥–æ–º–ª—è—Ç—å –∫–æ–ª–ª–µ–≥.\n\n"
        "üìå –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n"
        '‚úÖ "–ù–∞ —Ä–∞–±–æ—Ç–µ" ‚Äî –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏—Ö–æ–¥. –£–∫–∞–∂–∏—Ç–µ –≤–∞—à–∏ –§–ò–û –∏ –∞–¥—Ä–µ—Å –º–∞–≥–∞–∑–∏–Ω–∞ (–∏–∑ —Å–ø–∏—Å–∫–∞).\n'
        'üè† "–£—à—ë–ª" ‚Äî –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —É—Ö–æ–¥.\n'
        'üìñ "–°–ø—Ä–∞–≤–∫–∞" ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.\n'
        '"–ü–µ—Ä–µ—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è" ‚Äî –í —Å–ª—É—á–∞–µ –Ω–µ –≤–µ—Ä–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Å–µ–±–µ.\n\n'
        "üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: –ü—Ä–∏ –æ—Ç–º–µ—Ç–∫–µ –ø—Ä–∏—Ö–æ–¥–∞ –∏–ª–∏ —É—Ö–æ–¥–∞ –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–æ–±—â–∏—Ç –æ–± —ç—Ç–æ–º –≤ –æ–±—â–∏–π —á–∞—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.\n"
        'üë• –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤: –î–æ—Å—Ç—É–ø–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ö—Ç–æ –Ω–∞ —Ä–∞–±–æ—Ç–µ" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö. \n'
        "‚ö†Ô∏è –í–∞–∂–Ω–æ: –î–æ—Å—Ç—É–ø –∫ –±–æ—Ç—É —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏.\n\n"
    )

    await bot.send_message(
        chat_id=callback_query.from_user.id,
        text=text,
        reply_markup=start_menu_keyboard(),
    )


def register_handler_reference():
    """–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–ø—Ä–∞–≤–∫–∏"""
    router.callback_query.register(reference, F.data == "reference")
